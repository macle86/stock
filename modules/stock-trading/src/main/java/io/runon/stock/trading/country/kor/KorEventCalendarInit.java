package io.runon.stock.trading.country.kor;

import com.seomse.commons.utils.time.Times;
import io.runon.trading.CountryCode;
import io.runon.trading.TradingTimes;
import io.runon.trading.data.calendar.EventCalendar;
import io.runon.trading.data.jdbc.TradingJdbc;
import lombok.extern.slf4j.Slf4j;

/**
 * ETF 타겟종목 초기 매핑
 * 기준금리 등의 기타자료는 수집 프로젝트 참조.
 * @author macle
 */
@Slf4j
public class KorEventCalendarInit {

    public static void init(){

        futuresExpiration();
        optionExpiration();

        //선물 만기정보 등록
    }

    //선물 만기정보등록
    public static void futuresExpiration(){
        //Chat GPT
//        1990년: 3월 8일, 6월 14일, 9월 13일, 12월 13일
//        1991년: 3월 14일, 6월 13일, 9월 12일, 12월 12일
//        1992년: 3월 12일, 6월 11일, 9월 10일, 12월 10일
//        1993년: 3월 11일, 6월 10일, 9월 9일, 12월 9일
//        1994년: 3월 10일, 6월 9일, 9월 8일, 12월 8일
//        1995년: 3월 9일, 6월 8일, 9월 14일, 12월 14일
//        1996년: 3월 14일, 6월 13일, 9월 12일, 12월 12일
//        1997년: 3월 13일, 6월 12일, 9월 11일, 12월 11일
//        1998년: 3월 12일, 6월 11일, 9월 10일, 12월 10일
//        1999년: 3월 11일, 6월 10일, 9월 9일, 12월 9일
//        2000년: 3월 9일, 6월 8일, 9월 14일, 12월 14일
//        2001년: 3월 8일, 6월 14일, 9월 13일, 12월 13일
//        2002년: 3월 14일, 6월 13일, 9월 12일, 12월 12일
//        2003년: 3월 13일, 6월 12일, 9월 11일, 12월 11일
//        2004년: 3월 11일, 6월 10일, 9월 9일, 12월 9일
//        2005년: 3월 10일, 6월 9일, 9월 8일, 12월 8일
//        2006년: 3월 9일, 6월 8일, 9월 14일, 12월 14일
//        2007년: 3월 8일, 6월 14일, 9월 13일, 12월 13일
//        2008년: 3월 13일, 6월 12일, 9월 11일, 12월 11일
//        2009년: 3월 12일, 6월 11일, 9월 10일, 12월 10일
//        2010년: 3월 11일, 6월 10일, 9월 9일, 12월 9일
//        2011년: 3월 10일, 6월 9일, 9월 8일, 12월 8일
//        2012년: 3월 8일, 6월 14일, 9월 13일, 12월 13일
//        2013년: 3월 14일, 6월 13일, 9월 12일, 12월 12일
//        2014년: 3월 13일, 6월 12일, 9월 11일, 12월 11일
//        2015년: 3월 12일, 6월 11일, 9월 10일, 12월 10일
//        2016년: 3월 10일, 6월 9일, 9월 8일, 12월 8일
//        2017년: 3월 9일, 6월 8일, 9월 14일, 12월 14일
//        2018년: 3월 8일, 6월 14일, 9월 13일, 12월 13일
//        2019년: 3월 14일, 6월 13일, 9월 12일, 12월 12일
//        2020년: 3월 12일, 6월 11일, 9월 10일, 12월 10일
        //수동자료
//        2010 : {3:11, 6:10, 9:9,  12:9},
//        2011 : {3:10, 6:9,  9:8,  12:8},
//        2012 : {3:8,  6:14, 9:13, 12:13},
//        2013 : {3:14, 6:13, 9:12, 12:12},
//        2014 : {3:13, 6:12, 9:11, 12:11},
//        2015 : {3:12, 6:11, 9:10, 12:10},
//        2016 : {3:10, 6:9,  9:8,  12:8},
//        2017 : {3:9,  6:8,  9:14, 12:14},
//        2018 : {3:8,  6:14, 9:13, 12:13},
//        2019 : {3:14, 6:13, 9:11, 12:12},
//        2020 : {3:12, 6:11, 9:10, 12:10},
//        2021 : 3:11, 6:10, 9:09 . 12:09
//        2022 : 3:10, 6:09, 9:08, 12:08
//        2023 : 3.9, 6월8일, 9:14, 12월14
//        2024 : 3.14, 6.13 , 9.12, 12.12
        int [] ymds = {
                  19900308, 19900614, 19900913, 19901213
                , 19910314, 19910613, 19910912, 19911212
                , 19920312, 19920611, 19920910, 19921210
                , 19930311, 19930610, 19930909, 19931209
                , 19940310, 19940609, 19940908, 19941208
                , 19950309, 19950608, 19950914, 19951214
                , 19960314, 19960613, 19960912, 19961212
                , 19970313, 19970612, 19970911, 19971211
                , 19980312, 19980611, 19980910, 19981210
                , 19990311, 19990610, 19990909, 19991209
                , 20000309, 20000608, 20000914, 20001214
                , 20010308, 20010614, 20010913, 20011213
                , 20020314, 20020613, 20020912, 20021212
                , 20030313, 20030612, 20030911, 20031211
                , 20040311, 20040610, 20040909, 20041209
                , 20050310, 20050609, 20050908, 20051208
                , 20060309, 20060608, 20060914, 20061214
                , 20070308, 20070614, 20070913, 20071213
                , 20080313, 20080612, 20080911, 20081211
                , 20090312, 20090611, 20090910, 20091210
                , 20100311, 20100610, 20100909, 20101209
                , 20110310, 20110609, 20110908, 20111208
                , 20120308, 20120614, 20120913, 20121213
                , 20130314, 20130613, 20130912, 20131212
                , 20140313, 20140612, 20140911, 20141211
                , 20150312, 20150611, 20150910, 20151210
                , 20160310, 20160609, 20160908, 20161208
                , 20170309, 20170608, 20170914, 20171214
                , 20180308, 20180614, 20180913, 20181213
                , 20190314, 20190613, 20190911, 20191212
                , 20200312, 20200611, 20200910, 20201210
                , 20210311, 20210610, 20210909, 20211209
                , 20220310, 20220609, 20220908, 20221208
                , 20230309, 20230608, 20230914, 20231214
                , 20240314, 20240613, 20240912, 20241212
        };

        futuresExpiration(ymds);

    }

    public static void optionExpiration(){
        //
//    1990년대
//1990년: 1월 11일, 2월 8일, 3월 8일, 4월 12일, 5월 10일, 6월 14일, 7월 12일, 8월 9일, 9월 13일, 10월 11일, 11월 8일, 12월 13일
//1991년: 1월 10일, 2월 14일, 3월 14일, 4월 11일, 5월 9일, 6월 13일, 7월 11일, 8월 8일, 9월 12일, 10월 10일, 11월 14일, 12월 12일
//1992년: 1월 9일, 2월 13일, 3월 12일, 4월 9일, 5월 14일, 6월 11일, 7월 9일, 8월 13일, 9월 10일, 10월 8일, 11월 12일, 12월 10일
//1993년: 1월 14일, 2월 11일, 3월 11일, 4월 8일, 5월 13일, 6월 10일, 7월 8일, 8월 12일, 9월 9일, 10월 14일, 11월 11일, 12월 9일
//1994년: 1월 12일, 2월 9일, 3월 9일, 4월 14일, 5월 12일, 6월 9일, 7월 14일, 8월 11일, 9월 8일, 10월 13일, 11월 10일, 12월 8일
// 1995년: 1월 12일, 2월 9일, 3월 9일, 4월 13일, 5월 11일, 6월 8일, 7월 13일, 8월 10일, 9월 14일, 10월 12일, 11월 9일, 12월 14일
//1996년: 1월 11일, 2월 8일, 3월 14일, 4월 11일, 5월 9일, 6월 13일, 7월 11일, 8월 8일, 9월 12일, 10월 10일, 11월 14일, 12월 12일
//1997년: 1월 9일, 2월 13일, 3월 13일, 4월 10일, 5월 8일, 6월 12일, 7월 10일, 8월 14일, 9월 11일, 10월 9일, 11월 13일, 12월 11일
//1998년: 1월 8일, 2월 12일, 3월 12일, 4월 9일, 5월 14일, 6월 11일, 7월 9일, 8월 13일, 9월 10일, 10월 8일, 11월 12일, 12월 10일
//1999년: 1월 14일, 2월 11일, 3월 11일, 4월 8일, 5월 13일, 6월 10일, 7월 8일, 8월 12일, 9월 9일, 10월 14일, 11월 11일, 12월 9일
//2000년대
//2000년: 1월 13일, 2월 10일, 3월 9일, 4월 13일, 5월 11일, 6월 8일, 7월 13일, 8월 10일, 9월 14일, 10월 12일, 11월 9일, 12월 14일
//2001년: 1월 11일, 2월 8일, 3월 8일, 4월 12일, 5월 10일, 6월 14일, 7월 12일, 8월 9일, 9월 13일, 10월 11일, 11월 8일, 12월 13일
////2002년: 1월 10일, 2월 14일, 3월 14일, 4월 11일, 5월 9일, 6월 13일, 7월 11일, 8월 8일, 9월 12일, 10월 10일, 11월 14일, 12월 12일
////2003년: 1월 9일, 2월 13일, 3월 13일, 4월 10일, 5월 8일, 6월 12일, 7월 10일, 8월 14일, 9월 11일, 10월 9일, 11월 13일, 12월 11일
////2004년: 1월 8일, 2월 12일, 3월 11일, 4월 14일, 5월 13일, 6월 10일, 7월 8일, 8월 12일, 9월 9일, 10월 14일, 11월 11일, 12월 9일
////2005년: 1월 13일, 2월 10일, 3월 10일, 4월 14일, 5월 12일, 6월 9일, 7월 14일, 8월 11일, 9월 8일, 10월 13일, 11월 10일, 12월 8일
////2006년: 1월 12일, 2월 9일, 3월 9일, 4월 13일, 5월 11일, 6월 8일, 7월 13일, 8월 10일, 9월 14일, 10월 12일, 11월 9일, 12월 14일
////2007년: 1월 11일, 2월 8일, 3월 8일, 4월 12일, 5월 10일, 6월 14일, 7월 12일, 8월 9일, 9월 13일, 10월 11일, 11월 8일, 12월 13일
////2008년: 1월 10일, 2월 14일, 3월 13일, 4월 10일, 5월 8일, 6월 12일, 7월 10일, 8월 14일, 9월 11일, 10월 9일, 11월 13일, 12월 11일
////2009년: 1월 8일, 2월 12일, 3월 12일, 4월 9일, 5월 14일, 6월 11일, 7월 9일, 8월 13일, 9월 10일, 10월 8일, 11월 12일, 12월 10일
////2010년: 1월 14일, 2월 11일, 3월 11일, 4월 8일, 5월 13일, 6월 10일, 7월 8일, 8월 12일, 9월 9일, 10월 14일, 11월 11일, 12월 9일
        int [] ymds = {
                  19900111, 19900208, 19900308, 19900412, 19900510, 19900614, 19900712, 19900809, 19900913, 19901011, 19901108, 19901213
                , 19910110, 19910214, 19910314, 19910411, 19910509, 19910613, 19910711, 19910808, 19910912, 19911010, 19911114, 19911212
                , 19920109, 19920213, 19920312, 19920409, 19920514, 19920611, 19920709, 19920813, 19920910, 19921008, 19921112, 19921210
                , 19930114, 19930211, 19930311, 19930408, 19930513, 19930610, 19930708, 19930812, 19930909, 19931014, 19931111, 19931209
                , 19940112, 19940209, 19940309, 19940414, 19940512, 19940609, 19940714, 19940811, 19940908, 19941013, 19941110, 19941208
                , 19950112, 19950209, 19950309, 19950413, 19950511, 19950608, 19950713, 19950810, 19950914, 19951012, 19951109, 19951214
                , 19960111, 19960208, 19960314, 19960411, 19960509, 19960613, 19960711, 19960808, 19960912, 19961010, 19961114, 19961212
                , 19970109, 19970213, 19970313, 19970410, 19970508, 19970612, 19970710, 19970814, 19970911, 19971009, 19971113, 19971211
                , 19980108, 19980212, 19980312, 19980409, 19980514, 19980611, 19980709, 19980813, 19980910, 19981008, 19981112, 19981210
                , 19990114, 19990211, 19990311, 19990408, 19990513, 19990610, 19990708, 19990812, 19990909, 19991014, 19991111, 19991209
                , 20000113, 20000210, 20000309, 20000413, 20000511, 20000608, 20000713, 20000810, 20000914, 20001012, 20001109, 20001214
                , 20010111, 20010208, 20010308, 20010412, 20010510, 20010614, 20010712, 20010809, 20010913, 20011011, 20011108, 20011213
                , 20020110, 20020214, 20020314, 20020411, 20020509, 20020613, 20020711, 20020808, 20020912, 20021010, 20021114, 20021212
                , 20030109, 20030213, 20030313, 20030410, 20030508, 20030612, 20030710, 20030814, 20030911, 20031009, 20031113, 20031211
                , 20040108, 20040212, 20040311, 20040414, 20040513, 20040610, 20040708, 20040812, 20040909, 20041014, 20041111, 20041209
                , 20050113, 20050210, 20050310, 20050414, 20050512, 20050609, 20050714, 20050811, 20050908, 20051013, 20051110, 20051208
                , 20060112, 20060209, 20060309, 20060413, 20060511, 20060608, 20060713, 20060810, 20060914, 20061012, 20061109, 20061214
                , 20070111, 20070208, 20070308, 20070412, 20070510, 20070614, 20070712, 20070809, 20070913, 20071011, 20071108, 20071213
                , 20090108, 20090212, 20090312, 20090409, 20090514, 20090611, 20090709, 20090813, 20090910, 20091008, 20091112, 20091210
                , 20100114, 20100211, 20100311, 20100408, 20100513, 20100610, 20100708, 20100812, 20100909, 20101014, 20101111, 20101209
                , 20110113, 20110210, 20110310, 20110414, 20110512, 20110609, 20110714, 20110811, 20110908, 20111013, 20111110, 20111208
                , 20120112, 20120209, 20120308, 20120412, 20120510, 20120614, 20120712, 20120809, 20120913, 20121011, 20121108, 20121213
                , 20130110, 20130214, 20130314, 20130411, 20130509, 20130613, 20130711, 20130808, 20130912, 20131010, 20131114, 20131212
                , 20140109, 20140213, 20140313, 20140410, 20140508, 20140612, 20140710, 20140814, 20140911, 20141009, 20141113, 20141211
                , 20150108, 20150212, 20150312, 20150409, 20150514, 20150611, 20150709, 20150813, 20150910, 20151008, 20151112, 20151210
                , 20160114, 20160211, 20160310, 20160414, 20160512, 20160609, 20160714, 20160811, 20160908, 20161013, 20161110, 20161208
                , 20170112, 20170209, 20170309, 20170413, 20170511, 20170608, 20170713, 20170810, 20170914, 20171012, 20171109, 20171214
                , 20180111, 20180208, 20180308, 20180412, 20180510, 20180614, 20180712, 20180809, 20180913, 20181011, 20181108, 20181213
                , 20190110, 20190214, 20190314, 20190411, 20190509, 20190613, 20190711, 20190808, 20190912, 20191010, 20191114, 20191212
                , 20200109, 20200213, 20200312, 20200409, 20200514, 20200611, 20200709, 20200813, 20200910, 20201008, 20201112, 20201210
                , 20210114, 20210211, 20210311, 20210408, 20210513, 20210610, 20210708, 20210812, 20210909, 20211014, 20211111, 20211209
                , 20220113, 20220210, 20220310, 20220414, 20220512, 20220609, 20220714, 20220811, 20220908, 20221013, 20221110, 20221208
                , 20230112, 20230209, 20230309, 20230413, 20230511, 20230608, 20230713, 20230810, 20230914, 20231012, 20231109, 20231214
                , 20240111, 20240208, 20240314, 20240411, 20240509, 20240613, 20240711, 20240808, 20240912, 20241010, 20241114, 20241212
        };



        optionExpiration(ymds);
    }

    public static void futuresExpiration( int [] ymms){
        String closeHm = TradingTimes.getCloseTimeHm(CountryCode.KOR);

        String dateFormat = "yyyyMMdd hhmm";

        EventCalendar eventCalendar = new EventCalendar();

        eventCalendar.setCountry(CountryCode.KOR.toString());
        eventCalendar.setUpdatedAt(System.currentTimeMillis());
        eventCalendar.setNameKo("선물 만기일");
        eventCalendar.setNameEn("futures expiration");
        eventCalendar.setEventType("futures_expiration");

        for(int ymd : ymms){

            eventCalendar.setYmd(ymd);
            eventCalendar.setEventId(eventCalendar.getCountry() + "_" + eventCalendar.getEventType() +"_" +ymd);
            String timeText = eventCalendar.getYmd() +" " + closeHm;
            eventCalendar.setEventTime(Times.getTime(dateFormat, timeText, TradingTimes.KOR_ZONE_ID));

            TradingJdbc.updateTimeCheck(eventCalendar);

        }
    }

    public static void optionExpiration(int [] ymms){
        String closeHm = TradingTimes.getCloseTimeHm(CountryCode.KOR);

        String dateFormat = "yyyyMMdd hhmm";

        EventCalendar eventCalendar = new EventCalendar();

        eventCalendar.setCountry(CountryCode.KOR.toString());
        eventCalendar.setUpdatedAt(System.currentTimeMillis());
        eventCalendar.setNameKo("옵션 만기일");
        eventCalendar.setNameEn("option expiration");
        eventCalendar.setEventType("option_expiration");
        for(int ymd : ymms){
            eventCalendar.setYmd(ymd);
            eventCalendar.setEventId(eventCalendar.getCountry() + "_" + eventCalendar.getEventType() +"_" +ymd);
            String timeText = eventCalendar.getYmd() +" " + closeHm;
            eventCalendar.setEventTime(Times.getTime(dateFormat, timeText, TradingTimes.KOR_ZONE_ID));
            TradingJdbc.updateTimeCheck(eventCalendar);

        }
    }

    public static void main(String[] args) {
        init();
    }



}
